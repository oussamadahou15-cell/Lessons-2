<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>ูุญูุธุฉ ุฏุฑูุณู</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css"/>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body data-lang="ar">

<!-- LOADING -->
<div id="loading-screen">
  <div class="loader-inner">
    <div class="loader-logo">๐</div>
    <div class="loader-text">ูุญูุธุฉ ุฏุฑูุณู</div>
    <div class="loader-bar"><div class="loader-fill"></div></div>
  </div>
</div>

<!-- TOAST -->
<div id="toast-container"></div>

<!-- NAV -->
<nav id="main-nav">
  <div class="nav-inner">
    <div class="nav-logo" onclick="showPage('feed')">
      <span class="logo-icon">๐</span>
      <span class="logo-text">ูุญูุธุฉ ุฏุฑูุณู</span>
    </div>
    <!-- Search Bar -->
    <div class="nav-search" id="nav-search-wrap" style="display:none">
      <input type="text" id="nav-search" placeholder="ุงุจุญุซ ุนู ุทูุงุจ ุฃู ุฏุฑูุณ..." oninput="searchUsers(this.value)" autocomplete="off"/>
      <div id="search-results" class="search-dropdown"></div>
    </div>
    <div class="nav-actions">
      <div class="lang-switcher">
        <button class="lang-btn active" onclick="setLang('ar')">ุน</button>
        <button class="lang-btn" onclick="setLang('en')">EN</button>
        <button class="lang-btn" onclick="setLang('fr')">FR</button>
      </div>
      <button class="theme-toggle" onclick="toggleTheme()"><span id="theme-icon">๐</span></button>
      <!-- Notifications -->
      <div id="notif-btn" style="display:none;position:relative">
        <button class="icon-nav-btn" onclick="toggleNotifications()">๐<span id="notif-badge" class="notif-badge" style="display:none">0</span></button>
        <div id="notif-dropdown" class="notif-dropdown"></div>
      </div>
      <!-- Messages -->
      <div id="msg-btn" style="display:none;position:relative">
        <button class="icon-nav-btn" onclick="showPage('messages')">๐ฌ<span id="msg-badge" class="notif-badge msg-badge" style="display:none">0</span></button>
      </div>
      <div id="auth-nav-btns">
        <button class="btn btn-outline-sm" onclick="showPage('login')">ุฏุฎูู</button>
        <button class="btn btn-primary-sm" onclick="showPage('register')">ุญุณุงุจ ุฌุฏูุฏ</button>
      </div>
      <div id="user-nav" style="display:none">
        <div class="user-avatar-nav" onclick="toggleUserMenu()">
          <img id="user-avatar-img" src="" alt="" style="display:none;width:100%;height:100%;border-radius:50%;object-fit:cover"/>
          <span id="user-initial">ุฃ</span>
          <div id="user-dropdown" class="user-dropdown">
            <div class="user-info-drop">
              <strong id="user-name-drop"></strong>
              <span id="user-email-drop"></span>
            </div>
            <a href="#" onclick="showMyProfile()">๐ค <span>ูููู ุงูุดุฎุตู</span></a>
            <a href="#" onclick="showPage('subjects')">๐ <span>ููุงููุณู</span></a>
            <a href="#" onclick="showPage('settings')">โ๏ธ <span>ุงูุฅุนุฏุงุฏุงุช</span></a>
            <a href="#" onclick="logout()" style="color:var(--danger)">๐ช <span>ุฎุฑูุฌ</span></a>
          </div>
        </div>
      </div>
      <button class="hamburger" id="hamburger" onclick="toggleMobileMenu()">
        <span></span><span></span><span></span>
      </button>
    </div>
  </div>
  <!-- Mobile bottom nav -->
  <div class="mobile-bottom-nav" id="mobile-bottom-nav" style="display:none">
    <button onclick="showPage('feed')">๐<span>ุงูุฑุฆูุณูุฉ</span></button>
    <button onclick="showPage('discover')">๐<span>ุงูุชุดู</span></button>
    <button onclick="openPostModal()">โ<span>ูุดุฑ</span></button>
    <button onclick="showPage('messages')">๐ฌ<span>ุฑุณุงุฆู</span></button>
    <button onclick="showMyProfile()">๐ค<span>ุญุณุงุจู</span></button>
  </div>
</nav>

<main id="app">

  <!-- ===== HOME PAGE (pre-login) ===== -->
  <div id="page-home" class="page active">
    <div class="hero-section">
      <div class="hero-bg">
        <div class="hero-orb orb1"></div>
        <div class="hero-orb orb2"></div>
        <div class="hero-orb orb3"></div>
        <div class="hero-grid"></div>
      </div>
      <div class="hero-content">
        <div class="hero-badge">๐ <span>ุดุจูุฉ ุงูุทูุงุจ ุงูุชุนููููุฉ</span></div>
        <h1 class="hero-title"><span>ูุญูุธุฉ</span> <span class="highlight">ุฏุฑูุณู</span></h1>
        <p class="hero-sub">ุดุงุฑู ุฏุฑูุณูุ ุชูุงุตู ูุน ุฒููุงุฆูุ ูุชุนููู ูุนุงู โ ุงูููุตุฉ ุงูุงุฌุชูุงุนูุฉ ุงูุฃููู ููุทูุงุจ</p>
        <div class="hero-owner">
          <div class="owner-card">
            <div class="owner-avatar">ุฏุฃ</div>
            <div class="owner-info">
              <span class="owner-name">ุฏุญู ุฃุณุงูุฉ</span>
              <span class="owner-uni">๐ ุฌุงูุนุฉ ุงููุนุงูุฉ</span>
            </div>
          </div>
        </div>
        <div class="hero-actions">
          <button class="btn btn-hero-primary" onclick="showPage('register')">ุงุจุฏุฃ ูุฌุงูุงู <span class="btn-arrow">โ</span></button>
          <button class="btn btn-hero-outline" onclick="showPage('login')">ุชุณุฌูู ุงูุฏุฎูู</button>
        </div>
        <div class="hero-stats">
          <div class="stat"><span class="stat-num">๐</span><span class="stat-label">ุฏุฑูุณ ูุดุชุฑูุฉ</span></div>
          <div class="stat-divider"></div>
          <div class="stat"><span class="stat-num">๐ฅ</span><span class="stat-label">ูุฌุชูุน ุทูุงุจู</span></div>
          <div class="stat-divider"></div>
          <div class="stat"><span class="stat-num">๐ฌ</span><span class="stat-label">ุฏุฑุฏุดุฉ ููุฑูุฉ</span></div>
        </div>
      </div>
      <div class="hero-visual">
        <div class="floating-cards">
          <div class="fc fc1">๐ ุฏุฑุณ PDF</div>
          <div class="fc fc2">โค๏ธ 24 ุฅุนุฌุงุจ</div>
          <div class="fc fc3">๐ฌ ุชุนููู ุฌุฏูุฏ</div>
          <div class="fc fc4">๐ฅ ุทูุจ ุตุฏุงูุฉ</div>
          <div class="fc fc5">โญ ุชูููู 5/5</div>
        </div>
      </div>
    </div>
    <section class="features-section">
      <div class="section-header">
        <h2>ูููุฒุงุช ุงูููุตุฉ</h2>
        <p>ูู ูุง ุชุญุชุงุฌู ูุทุงูุจ ูู ููุงู ูุงุญุฏ</p>
      </div>
      <div class="features-grid">
        <div class="feature-card"><div class="feature-icon" style="background:var(--grad-blue)">๐ฅ</div><h3>ุดุจูุฉ ุงุฌุชูุงุนูุฉ</h3><p>ุฃุถู ุฃุตุฏูุงุกุ ุชุงุจุนููุ ูุชูุงุนู ูุน ุฏุฑูุณูู</p></div>
        <div class="feature-card"><div class="feature-icon" style="background:var(--grad-purple)">๐ค</div><h3>ูุดุฑ ุงูุฏุฑูุณ</h3><p>ุดุงุฑู ูููุงุชู ูุน ุฒููุงุฆู ูุฃุถู ุชุนูููุงุช</p></div>
        <div class="feature-card"><div class="feature-icon" style="background:var(--grad-green)">๐ฌ</div><h3>ุฏุฑุฏุดุฉ ููุฑูุฉ</h3><p>ุชุญุฏุซ ูุน ุฃุตุฏูุงุฆู ูุจุงุดุฑุฉ ุฏุงุฎู ุงูููุตุฉ</p></div>
        <div class="feature-card"><div class="feature-icon" style="background:var(--grad-orange)">โค๏ธ</div><h3>ุฅุนุฌุงุจ ูุชูููู</h3><p>ูููู ุงูุฏุฑูุณ ูุฃุถู ุชุนูููุงุชู</p></div>
        <div class="feature-card"><div class="feature-icon" style="background:var(--grad-pink)">๐ค</div><h3>ุฐูุงุก ุงุตุทูุงุนู</h3><p>ูุณุงุนุฏ ุฐูู ูุฌูุจ ุนูู ุฃุณุฆูุชู ุงูุฏุฑุงุณูุฉ</p></div>
        <div class="feature-card"><div class="feature-icon" style="background:var(--grad-teal)">๐งฎ</div><h3>ุญุงุณุจุฉ ุงููุนุฏู</h3><p>ุงุญุณุจ ูุนุฏูู ูุญููู ุฃุฏุงุกู ุงูุฏุฑุงุณู</p></div>
      </div>
    </section>
  </div>

  <!-- ===== LOGIN ===== -->
  <div id="page-login" class="page">
    <div class="auth-page">
      <div class="auth-bg"><div class="auth-orb a1"></div><div class="auth-orb a2"></div></div>
      <div class="auth-card">
        <div class="auth-logo">๐</div>
        <h2 class="auth-title">ูุฑุญุจุงู ุจุนูุฏุชู</h2>
        <p class="auth-sub">ุณุฌูู ุงูุฏุฎูู ููุชุงุจุนุฉ ุฏุฑูุณู</p>
        <!-- Social Login -->
        <div class="social-login">
          <button class="social-btn google-btn" onclick="loginWithGoogle()">
            <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
            <span>ุงูุฏุฎูู ุจู Google</span>
          </button>
          <button class="social-btn facebook-btn" onclick="loginWithFacebook()">
            <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#1877F2" d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
            <span>ุงูุฏุฎูู ุจู Facebook</span>
          </button>
        </div>
        <div class="divider"><span>ุฃู ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู</span></div>
        <form onsubmit="handleLogin(event)">
          <div class="form-group">
            <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input type="email" id="login-email" class="form-input" required/>
          </div>
          <div class="form-group">
            <label>ูููุฉ ุงููุฑูุฑ</label>
            <div class="input-wrap">
              <input type="password" id="login-password" class="form-input" required/>
              <button type="button" class="eye-btn" onclick="togglePass('login-password')">๐</button>
            </div>
          </div>
          <div class="form-options">
            <a href="#" class="forgot-link" onclick="showPage('forgot')">ูุณูุช ูููุฉ ุงููุฑูุฑุ</a>
          </div>
          <button type="submit" class="btn btn-primary btn-full">ุชุณุฌูู ุงูุฏุฎูู</button>
        </form>
        <p class="auth-switch">ููุณ ูุฏูู ุญุณุงุจุ <a href="#" onclick="showPage('register')">ุฃูุดุฆ ุญุณุงุจุงู</a></p>
      </div>
    </div>
  </div>

  <!-- ===== REGISTER ===== -->
  <div id="page-register" class="page">
    <div class="auth-page">
      <div class="auth-bg"><div class="auth-orb a1"></div><div class="auth-orb a2"></div></div>
      <div class="auth-card">
        <div class="auth-logo">๐</div>
        <h2 class="auth-title">ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</h2>
        <p class="auth-sub">ุงูุถู ููุฌุชูุน ุงูุทูุงุจ</p>
        <div class="social-login">
          <button class="social-btn google-btn" onclick="loginWithGoogle()">
            <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/><path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/><path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/><path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/></svg>
            <span>ุงูุชุณุฌูู ุจู Google</span>
          </button>
          <button class="social-btn facebook-btn" onclick="loginWithFacebook()">
            <svg width="18" height="18" viewBox="0 0 24 24"><path fill="#1877F2" d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
            <span>ุงูุชุณุฌูู ุจู Facebook</span>
          </button>
        </div>
        <div class="divider"><span>ุฃู ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู</span></div>
        <form onsubmit="handleRegister(event)">
          <div class="form-group">
            <label>ุงูุงุณู ุงููุงูู</label>
            <input type="text" id="reg-name" class="form-input" required/>
          </div>
          <div class="form-group">
            <label>ุงุณู ุงููุณุชุฎุฏู</label>
            <input type="text" id="reg-username" class="form-input" placeholder="ูุซุงู: ahmed_student" required/>
          </div>
          <div class="form-group">
            <label>ุงูุฌุงูุนุฉ</label>
            <input type="text" id="reg-university" class="form-input" placeholder="ุงุณู ุฌุงูุนุชู"/>
          </div>
          <div class="form-group">
            <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input type="email" id="reg-email" class="form-input" required/>
          </div>
          <div class="form-group">
            <label>ูููุฉ ุงููุฑูุฑ</label>
            <div class="input-wrap">
              <input type="password" id="reg-password" class="form-input" minlength="6" required/>
              <button type="button" class="eye-btn" onclick="togglePass('reg-password')">๐</button>
            </div>
          </div>
          <button type="submit" class="btn btn-primary btn-full">ุฅูุดุงุก ุงูุญุณุงุจ</button>
        </form>
        <p class="auth-switch">ูุฏูู ุญุณุงุจุ <a href="#" onclick="showPage('login')">ุณุฌูู ุงูุฏุฎูู</a></p>
      </div>
    </div>
  </div>

  <!-- ===== FORGOT ===== -->
  <div id="page-forgot" class="page">
    <div class="auth-page">
      <div class="auth-bg"><div class="auth-orb a1"></div><div class="auth-orb a2"></div></div>
      <div class="auth-card">
        <div class="auth-logo">๐</div>
        <h2 class="auth-title">ุงุณุชุฑุฌุงุน ูููุฉ ุงููุฑูุฑ</h2>
        <form onsubmit="handleForgot(event)">
          <div class="form-group">
            <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
            <input type="email" id="forgot-email" class="form-input" required/>
          </div>
          <button type="submit" class="btn btn-primary btn-full">ุฅุฑุณุงู ุงูุฑุงุจุท</button>
        </form>
        <p class="auth-switch"><a href="#" onclick="showPage('login')">โ ุงูุนูุฏุฉ ูุชุณุฌูู ุงูุฏุฎูู</a></p>
      </div>
    </div>
  </div>

  <!-- ===== FEED (Social Wall) ===== -->
  <div id="page-feed" class="page">
    <div class="social-layout">
      <!-- Left Sidebar -->
      <div class="social-sidebar-left">
        <div class="sidebar-profile-mini" id="sidebar-profile-mini"></div>
        <div class="sidebar-nav">
          <button class="sidebar-nav-btn active" onclick="showPage('feed')">๐ ุงูุฑุฆูุณูุฉ</button>
          <button class="sidebar-nav-btn" onclick="showPage('discover')">๐ ุงูุชุดู ุทูุงุจุงู</button>
          <button class="sidebar-nav-btn" onclick="showPage('friends')">๐ฅ ุงูุฃุตุฏูุงุก</button>
          <button class="sidebar-nav-btn" onclick="showPage('messages')">๐ฌ ุงูุฑุณุงุฆู</button>
          <button class="sidebar-nav-btn" onclick="showPage('subjects')">๐ ููุงููุณู</button>
          <button class="sidebar-nav-btn" onclick="showPage('lessons')">๐ ุฏุฑูุณู</button>
          <button class="sidebar-nav-btn" onclick="showPage('chat')">๐ค ุงูุฐูุงุก ุงูุงุตุทูุงุนู</button>
          <button class="sidebar-nav-btn" onclick="showPage('calculator')">๐งฎ ุงูุญุงุณุจุฉ</button>
          <button class="sidebar-nav-btn" onclick="showPage('about')">โน๏ธ ุญูู ุงูุชุทุจูู</button>
        </div>
      </div>
      <!-- Main Feed -->
      <div class="social-main">
        <!-- Post Creator -->
        <div class="post-creator" id="post-creator">
          <div class="post-creator-top">
            <div class="post-creator-avatar" id="post-creator-avatar"></div>
            <div class="post-creator-input" onclick="openPostModal()">ูุงุฐุง ุชุฑูุฏ ุฃู ุชุดุงุฑูุ ๐</div>
          </div>
          <div class="post-creator-actions">
            <button onclick="openPostModal('file')">๐ ููู</button>
            <button onclick="openPostModal('image')">๐ผ๏ธ ุตูุฑุฉ</button>
            <button onclick="openPostModal('video')">๐ฅ ููุฏูู</button>
            <button onclick="openPostModal('text')">โ๏ธ ูุต</button>
          </div>
        </div>
        <!-- Posts Feed -->
        <div id="posts-feed">
          <div class="loading-placeholder"><div class="spinner"></div><p>ุฌุงุฑู ุชุญููู ุงูููุดูุฑุงุช...</p></div>
        </div>
      </div>
      <!-- Right Sidebar -->
      <div class="social-sidebar-right">
        <div class="sidebar-widget">
          <h4>ุทูุจุงุช ุงูุตุฏุงูุฉ</h4>
          <div id="friend-requests-widget"></div>
        </div>
        <div class="sidebar-widget">
          <h4>ุฃุดุฎุงุต ูุฏ ุชุนุฑููู</h4>
          <div id="suggestions-widget"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== DISCOVER ===== -->
  <div id="page-discover" class="page">
    <div class="inner-page">
      <div class="page-header">
        <div><h1>๐ ุงูุชุดู ุทูุงุจุงู</h1><p>ุงุจุญุซ ูุฃุถู ุฒููุงุกู</p></div>
      </div>
      <div class="search-bar-big">
        <input type="text" id="discover-search" class="form-input" placeholder="ุงุจุญุซ ุจุงุณู ุงููุณุชุฎุฏู ุฃู ุงูุงุณู ุฃู ุงูุฌุงูุนุฉ..." oninput="discoverSearch(this.value)"/>
      </div>
      <div id="discover-results" class="users-grid"></div>
    </div>
  </div>

  <!-- ===== FRIENDS ===== -->
  <div id="page-friends" class="page">
    <div class="inner-page">
      <div class="page-header">
        <div><h1>๐ฅ ุงูุฃุตุฏูุงุก</h1></div>
      </div>
      <div class="friends-tabs">
        <button class="friends-tab active" onclick="switchFriendsTab('all',this)">ูู ุงูุฃุตุฏูุงุก</button>
        <button class="friends-tab" onclick="switchFriendsTab('requests',this)">ุทูุจุงุช ูุนููุฉ <span id="req-count-badge" class="tab-badge"></span></button>
        <button class="friends-tab" onclick="switchFriendsTab('sent',this)">ุทูุจุงุช ูุฑุณูุฉ</button>
      </div>
      <div id="friends-content" class="users-grid"></div>
    </div>
  </div>

  <!-- ===== MESSAGES ===== -->
  <div id="page-messages" class="page">
    <div class="messages-layout">
      <div class="messages-sidebar">
        <div class="messages-sidebar-header">
          <h3>๐ฌ ุงูุฑุณุงุฆู</h3>
          <input type="text" placeholder="ุจุญุซ..." class="form-input" style="margin-top:0.7rem" oninput="searchConversations(this.value)"/>
        </div>
        <div id="conversations-list"></div>
      </div>
      <div class="messages-main" id="messages-main">
        <div class="messages-empty">
          <div style="font-size:4rem;margin-bottom:1rem">๐ฌ</div>
          <h3>ุงุฎุชุฑ ูุญุงุฏุซุฉ</h3>
          <p>ุงุฎุชุฑ ุตุฏููุงู ูุจุฏุก ุงููุญุงุฏุซุฉ</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== PROFILE PAGE ===== -->
  <div id="page-profile" class="page">
    <div class="profile-page">
      <div class="profile-cover" id="profile-cover">
        <button class="change-cover-btn" id="change-cover-btn" onclick="changeCover()" style="display:none">๐ท ุชุบููุฑ ุงูุบูุงู</button>
      </div>
      <div class="profile-info-bar">
        <div class="profile-avatar-wrap">
          <div class="profile-avatar" id="profile-avatar-display"></div>
          <button class="change-avatar-btn" id="change-avatar-btn" onclick="changeAvatar()" style="display:none">๐ท</button>
        </div>
        <div class="profile-meta">
          <h2 id="profile-name-display"></h2>
          <p id="profile-username-display" class="profile-username"></p>
          <p id="profile-uni-display" class="profile-uni-display"></p>
          <p id="profile-bio-display" class="profile-bio-display"></p>
        </div>
        <div class="profile-actions" id="profile-actions"></div>
      </div>
      <div class="profile-stats-bar">
        <div class="profile-stat"><span id="profile-posts-count">0</span><span>ููุดูุฑ</span></div>
        <div class="profile-stat"><span id="profile-friends-count">0</span><span>ุตุฏูู</span></div>
        <div class="profile-stat"><span id="profile-likes-count">0</span><span>ุฅุนุฌุงุจ</span></div>
      </div>
      <div class="profile-tabs">
        <button class="profile-tab active" onclick="switchProfileTab('posts',this)">ุงูููุดูุฑุงุช</button>
        <button class="profile-tab" onclick="switchProfileTab('lessons',this)">ุงูุฏุฑูุณ</button>
      </div>
      <div id="profile-content" class="profile-content"></div>
    </div>
  </div>

  <!-- ===== SUBJECTS ===== -->
  <div id="page-subjects" class="page">
    <div class="inner-page">
      <div class="page-header">
        <div><h1>๐ ููุงููุณู</h1><p>ูุธูู ูุฃุฏุฑ ููุงููุณู ุงูุฏุฑุงุณูุฉ</p></div>
        <button class="btn btn-primary" onclick="openSubjectModal()">+ ุฅุถุงูุฉ ูููุงุณ</button>
      </div>
      <div id="subjects-grid" class="subjects-grid">
        <div class="loading-placeholder"><div class="spinner"></div><p>ุฌุงุฑู ุงูุชุญููู...</p></div>
      </div>
    </div>
  </div>

  <!-- ===== LESSONS ===== -->
  <div id="page-lessons" class="page">
    <div class="inner-page">
      <div class="page-header">
        <div><h1>๐ ุฏุฑูุณู</h1><p>ุงุฑูุน ูุนุฑุถ ูููุงุช ุฏุฑูุณู</p></div>
        <button class="btn btn-primary" onclick="openLessonModal()">+ ุฅุถุงูุฉ ุฏุฑุณ</button>
      </div>
      <div class="filter-bar">
        <label>ุชุตููุฉ:</label>
        <select id="lesson-filter" class="form-select" onchange="filterLessons()">
          <option value="all">ุฌููุน ุงูููุงููุณ</option>
        </select>
      </div>
      <div id="lessons-grid" class="lessons-grid">
        <div class="loading-placeholder"><div class="spinner"></div></div>
      </div>
    </div>
  </div>

  <!-- ===== AI CHAT ===== -->
  <div id="page-chat" class="page">
    <div class="chat-layout">
      <div class="chat-sidebar">
        <div class="chat-sidebar-header">๐ค ุงููุณุงุนุฏ ุงูุฐูู</div>
        <button class="btn btn-primary" onclick="newChat()" style="margin:1rem;width:calc(100% - 2rem)">+ ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ</button>
        <div id="chat-history" class="chat-history"></div>
      </div>
      <div class="chat-main">
        <div class="chat-header-bar"><span>๐ค</span><span>ุงููุณุงุนุฏ ุงูุฐูู</span><div class="chat-model-badge">AI</div></div>
        <div id="chat-messages" class="chat-messages">
          <div class="chat-welcome">
            <div class="welcome-robot">๐ค</div>
            <h3>ูุฑุญุจุงู! ููู ูููููู ูุณุงุนุฏุชูุ</h3>
            <p>ุงุณุฃููู ุฃู ุดูุก ุนู ุฏุฑูุณู</p>
            <div class="quick-prompts">
              <button class="quick-btn" onclick="sendQuickPrompt(this)">ุดุฑุญ ููููู ุฑูุงุถู</button>
              <button class="quick-btn" onclick="sendQuickPrompt(this)">ุชูุฎูุต ูุต</button>
              <button class="quick-btn" onclick="sendQuickPrompt(this)">ูุณุงุนุฏุฉ ูู ุงููุงุฌุจ</button>
            </div>
          </div>
        </div>
        <div class="chat-input-area">
          <div class="chat-input-wrap">
            <textarea id="chat-input" class="chat-textarea" placeholder="ุงูุชุจ ุณุคุงูู ููุง..." rows="1" onkeydown="handleChatKey(event)" oninput="autoResize(this)"></textarea>
            <button class="chat-send-btn" onclick="sendMessage()">โค</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== CALCULATOR ===== -->
  <div id="page-calculator" class="page">
    <div class="inner-page">
      <div class="page-header"><div><h1>๐งฎ ุญุงุณุจุฉ ุงููุนุฏู</h1><p>ุงุญุณุจ ูุนุฏูู ูุญูู ุฃุฏุงุกู</p></div></div>
      <div class="calc-layout">
        <div class="calc-form-section">
          <div class="calc-card">
            <h3>ุฅุฏุฎุงู ุงูุฏุฑุฌุงุช</h3>
            <div id="grades-list">
              <div class="grade-row">
                <input type="text" class="form-input" placeholder="ุงุณู ุงููุงุฏุฉ">
                <input type="number" class="form-input" placeholder="ุงูุฏุฑุฌุฉ /20" min="0" max="20">
                <input type="number" class="form-input" placeholder="ุงููุนุงูู" min="1" max="10" value="1">
                <button class="btn-icon danger" onclick="removeGradeRow(this)">๐</button>
              </div>
            </div>
            <button class="btn btn-outline btn-full" onclick="addGradeRow()" style="margin-top:1rem">+ ุฅุถุงูุฉ ูุงุฏุฉ</button>
            <button class="btn btn-primary btn-full" onclick="calculateGrades()" style="margin-top:1rem">ุงุญุณุจ ุงููุนุฏู</button>
          </div>
        </div>
        <div class="calc-result-section" id="calc-results" style="display:none">
          <div class="result-card">
            <div class="result-circle" id="result-circle">
              <span id="result-score">0.00</span><small>/20</small>
            </div>
            <h3 id="result-mention" class="result-mention"></h3>
            <div class="result-bars" id="result-bars"></div>
            <div class="result-analysis" id="result-analysis"></div>
            <div class="result-tips" id="result-tips"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== SETTINGS ===== -->
  <div id="page-settings" class="page">
    <div class="inner-page" style="max-width:600px">
      <div class="page-header"><div><h1>โ๏ธ ุงูุฅุนุฏุงุฏุงุช</h1></div></div>
      <div class="settings-card">
        <h3>ุชุนุฏูู ุงูููู ุงูุดุฎุตู</h3>
        <div class="form-group"><label>ุงูุงุณู ุงููุงูู</label><input type="text" id="settings-name" class="form-input"/></div>
        <div class="form-group"><label>ุงุณู ุงููุณุชุฎุฏู</label><input type="text" id="settings-username" class="form-input"/></div>
        <div class="form-group"><label>ุงูุฌุงูุนุฉ</label><input type="text" id="settings-university" class="form-input"/></div>
        <div class="form-group"><label>ูุจุฐุฉ ุนูู</label><textarea id="settings-bio" class="form-textarea" rows="3" placeholder="ุงูุชุจ ูุจุฐุฉ ูุตูุฑุฉ..."></textarea></div>
        <button class="btn btn-primary" onclick="saveSettings()">ุญูุธ ุงูุชุบููุฑุงุช</button>
      </div>
    </div>
  </div>

  <!-- ===== ABOUT ===== -->
  <div id="page-about" class="page">
    <div class="about-page">
      <div class="about-hero">
        <div class="about-orb"></div>
        <div class="about-content">
          <div class="about-avatar">ุฏุฃ</div>
          <h1>ุญูู ุงูุชุทุจูู</h1>
          <div class="about-owner-info">
            <h2>ุฏุญู ุฃุณุงูุฉ</h2>
            <p class="about-uni">๐ ุฌุงูุนุฉ ุงููุนุงูุฉ</p>
          </div>
        </div>
      </div>
      <div class="about-cards">
        <div class="about-card">
          <div class="about-card-icon">๐ฏ</div>
          <h3>ูุฏู ุงูุชุทุจูู</h3>
          <p>ููุตุฉ ุงุฌุชูุงุนูุฉ ุชุนููููุฉ ุชุฌูุน ุงูุทูุงุจ ููุดุงุฑูุฉ ุงูุฏุฑูุณ ูุงูุชุนุงูู ูู ุงูุฏุฑุงุณุฉ ูุจูุงุก ูุฌุชูุน ุทูุงุจู ูุชูุงูู</p>
        </div>
        <div class="about-card">
          <div class="about-card-icon">โจ</div>
          <h3>ุงููููุฒุงุช</h3>
          <ul class="about-list">
            <li>ุดุจูุฉ ุงุฌุชูุงุนูุฉ ููุทูุงุจ</li>
            <li>ูุดุงุฑูุฉ ุงูุฏุฑูุณ ูุงููููุงุช</li>
            <li>ุฏุฑุฏุดุฉ ููุฑูุฉ</li>
            <li>ุฐูุงุก ุงุตุทูุงุนู</li>
            <li>ุญุงุณุจุฉ ุงููุนุฏู</li>
            <li>ุฏุนู 3 ูุบุงุช</li>
          </ul>
        </div>
        <div class="about-card">
          <div class="about-card-icon">๐ฌ</div>
          <h3>ุงูุชูุงุตู</h3>
          <p>ุฌุงูุนุฉ ุงููุนุงูุฉ โ ุงูุฌุฒุงุฆุฑ</p>
          <p style="margin-top:0.5rem;color:var(--text3);font-size:0.85rem">ุงููุณุฎุฉ 2.0</p>
        </div>
      </div>
    </div>
  </div>

</main>

<!-- ===== MODALS ===== -->

<!-- Post Modal -->
<div id="post-modal" class="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <h3>๐ค ูุดุฑ ุฏุฑุณ ุฃู ูุญุชูู</h3>
      <button class="modal-close" onclick="closeModal('post-modal')">โ</button>
    </div>
    <form id="post-form" onsubmit="submitPost(event)" style="padding:1.5rem">
      <div class="form-group">
        <textarea id="post-text" class="form-textarea" rows="3" placeholder="ุงูุชุจ ูุตูุงู ููุฏุฑุณ ุฃู ูุญุชูู ุชุฑูุฏ ูุดุงุฑูุชู..."></textarea>
      </div>
      <div class="form-group">
        <label>ุงููููุงุณ (ุงุฎุชูุงุฑู)</label>
        <select id="post-subject" class="form-select">
          <option value="">ุจุฏูู ูููุงุณ</option>
        </select>
      </div>
      <div class="form-group">
        <label>ุฑูุน ููู (PDF, Word, PPT, ุตูุฑุฉ, ููุฏูู, ุตูุช)</label>
        <div class="upload-zone" id="post-upload-zone" onclick="document.getElementById('post-file-input').click()" ondragover="dragOver(event)" ondrop="dropPostFile(event)">
          <div class="upload-icon">๐ค</div>
          <p>ุงุณุญุจ ุงูููู ููุง ุฃู ุงุถุบุท ููุงุฎุชูุงุฑ</p>
          <small>ุฌููุน ุงูุตูุบ ูุฏุนููุฉ</small>
          <input type="file" id="post-file-input" style="display:none" accept="*/*" onchange="handlePostFile(event)"/>
        </div>
        <div id="post-file-preview" style="display:none"></div>
      </div>
      <div id="post-upload-progress" style="display:none">
        <div class="progress-bar"><div class="progress-fill" id="post-progress-fill"></div></div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline" onclick="closeModal('post-modal')">ุฅูุบุงุก</button>
        <button type="submit" class="btn btn-primary">ูุดุฑ ๐</button>
      </div>
    </form>
  </div>
</div>

<!-- Subject Modal -->
<div id="subject-modal" class="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <h3 id="subject-modal-title">ุฅุถุงูุฉ ูููุงุณ</h3>
      <button class="modal-close" onclick="closeModal('subject-modal')">โ</button>
    </div>
    <form id="subject-form" onsubmit="saveSubject(event)" style="padding:1.5rem">
      <div class="form-group"><label>ุงุณู ุงููููุงุณ</label><input type="text" id="subject-name" class="form-input" required/></div>
      <div class="form-group">
        <label>ุงูููู</label>
        <div class="color-picker">
          <div class="color-opt active" data-color="#6366f1" style="background:#6366f1" onclick="selectColor('#6366f1',this)"></div>
          <div class="color-opt" data-color="#10b981" style="background:#10b981" onclick="selectColor('#10b981',this)"></div>
          <div class="color-opt" data-color="#f59e0b" style="background:#f59e0b" onclick="selectColor('#f59e0b',this)"></div>
          <div class="color-opt" data-color="#ef4444" style="background:#ef4444" onclick="selectColor('#ef4444',this)"></div>
          <div class="color-opt" data-color="#8b5cf6" style="background:#8b5cf6" onclick="selectColor('#8b5cf6',this)"></div>
          <div class="color-opt" data-color="#06b6d4" style="background:#06b6d4" onclick="selectColor('#06b6d4',this)"></div>
        </div>
        <input type="hidden" id="subject-color" value="#6366f1"/>
      </div>
      <div class="form-group">
        <label>ุงูุฑูุฒ</label>
        <div class="emoji-picker">
          <span onclick="selectEmoji('๐',this)" class="emoji-opt active">๐</span>
          <span onclick="selectEmoji('๐ฌ',this)" class="emoji-opt">๐ฌ</span>
          <span onclick="selectEmoji('๐งฎ',this)" class="emoji-opt">๐งฎ</span>
          <span onclick="selectEmoji('๐ป',this)" class="emoji-opt">๐ป</span>
          <span onclick="selectEmoji('๐',this)" class="emoji-opt">๐</span>
          <span onclick="selectEmoji('๐',this)" class="emoji-opt">๐</span>
          <span onclick="selectEmoji('โก',this)" class="emoji-opt">โก</span>
          <span onclick="selectEmoji('๐จ',this)" class="emoji-opt">๐จ</span>
        </div>
        <input type="hidden" id="subject-icon" value="๐"/>
      </div>
      <div class="form-group"><label>ุงููุนุงูู</label><input type="number" id="subject-coefficient" class="form-input" min="1" max="10" value="1"/></div>
      <input type="hidden" id="subject-id" value=""/>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline" onclick="closeModal('subject-modal')">ุฅูุบุงุก</button>
        <button type="submit" class="btn btn-primary">ุญูุธ</button>
      </div>
    </form>
  </div>
</div>

<!-- Lesson Modal -->
<div id="lesson-modal" class="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <h3 id="lesson-modal-title">ุฅุถุงูุฉ ุฏุฑุณ</h3>
      <button class="modal-close" onclick="closeModal('lesson-modal')">โ</button>
    </div>
    <form id="lesson-form" onsubmit="saveLesson(event)" style="padding:1.5rem">
      <div class="form-group"><label>ุนููุงู ุงูุฏุฑุณ</label><input type="text" id="lesson-title-input" class="form-input" required/></div>
      <div class="form-group"><label>ุงููููุงุณ</label><select id="lesson-subject-sel" class="form-select" required></select></div>
      <div class="form-group"><label>ุงููุตู</label><textarea id="lesson-desc" class="form-textarea" rows="2"></textarea></div>
      <div class="form-group">
        <label>ุฑูุน ููู</label>
        <div class="upload-zone" id="upload-zone" onclick="document.getElementById('file-input').click()" ondragover="dragOver(event)" ondrop="dropFile(event)">
          <div class="upload-icon">๐ค</div>
          <p>ุงุณุญุจ ุงูููู ููุง ุฃู ุงุถุบุท ููุงุฎุชูุงุฑ</p>
          <small>PDF, Word, PPT, ุตูุฑุฉ, ููุฏูู, ุตูุช, TXT</small>
          <input type="file" id="file-input" style="display:none" accept="*/*" onchange="handleFileSelect(event)"/>
        </div>
        <div id="file-preview" class="file-preview" style="display:none"></div>
      </div>
      <div class="upload-progress" id="upload-progress" style="display:none">
        <div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div>
        <span id="progress-text">0%</span>
      </div>
      <input type="hidden" id="lesson-id" value=""/>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline" onclick="closeModal('lesson-modal')">ุฅูุบุงุก</button>
        <button type="submit" class="btn btn-primary">ุญูุธ</button>
      </div>
    </form>
  </div>
</div>

<!-- Viewer Modal -->
<div id="viewer-modal" class="modal-overlay viewer-overlay">
  <div class="modal viewer-modal">
    <div class="modal-header">
      <h3 id="viewer-title">ุนุฑุถ ุงูููู</h3>
      <div style="display:flex;gap:0.5rem;align-items:center">
        <a id="viewer-download" href="#" download class="btn btn-outline-sm">ุชุญููู</a>
        <button class="modal-close" onclick="closeModal('viewer-modal')">โ</button>
      </div>
    </div>
    <div id="viewer-content" class="viewer-content"></div>
  </div>
</div>

<!-- Confirm Modal -->
<div id="confirm-modal" class="modal-overlay">
  <div class="modal modal-sm">
    <div class="modal-header">
      <h3>ุชุฃููุฏ ุงูุญุฐู</h3>
      <button class="modal-close" onclick="closeModal('confirm-modal')">โ</button>
    </div>
    <p style="padding:1rem 1.5rem;color:var(--text2)">ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุนูุตุฑุ</p>
    <div class="modal-footer" style="padding:0 1.5rem 1.5rem">
      <button class="btn btn-outline" onclick="closeModal('confirm-modal')">ุฅูุบุงุก</button>
      <button class="btn btn-danger" id="confirm-ok-btn">ุญุฐู</button>
    </div>
  </div>
</div>

<!-- Comments Modal -->
<div id="comments-modal" class="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <h3>๐ฌ ุงูุชุนูููุงุช</h3>
      <button class="modal-close" onclick="closeModal('comments-modal')">โ</button>
    </div>
    <div id="comments-list" style="padding:1rem;max-height:350px;overflow-y:auto"></div>
    <div style="padding:1rem;border-top:1px solid var(--border)">
      <div style="display:flex;gap:0.5rem">
        <input type="text" id="comment-input" class="form-input" placeholder="ุงูุชุจ ุชุนูููุงู..." onkeydown="if(event.key==='Enter')submitComment()"/>
        <button class="btn btn-primary" onclick="submitComment()">ุฅุฑุณุงู</button>
      </div>
    </div>
  </div>
</div>

<input type="hidden" id="current-post-id" value=""/>
<input type="file" id="avatar-file-input" style="display:none" accept="image/*" onchange="uploadAvatar(event)"/>
<input type="file" id="cover-file-input" style="display:none" accept="image/*" onchange="uploadCover(event)"/>

<script src="main.js"></script>
</body>
</html>
